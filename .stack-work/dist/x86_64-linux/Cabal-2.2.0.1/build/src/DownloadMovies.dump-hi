
==================== FINAL INTERFACE ====================
2018-12-12 22:41:11.345488997 UTC

interface topmovies-0.1.0.0-HqDPykmlaSdETrGbngTKrW:DownloadMovies 8044
  interface hash: 3a8ef6b962623031e5a81eea0e2e4f8c
  ABI hash: 2252451e907dc40ef79fa54e3ca5008d
  export-list hash: 86b35fe2c62f46d65097d3df8d969130
  orphan hash: 693e9af84d3dfcc71e640e005bdc5e2e
  flag hash: 1f596daf84c7527444ae092b33472386
  opt_hash: 14e536840aca4e889cad654e6f9b79c1
  hpc_hash: 93b885adfe0da089cdf634904fd59f71
  sig of: Nothing
  used TH splices: False
  where
exports:
  DownloadMovies.downloadMovies
  DownloadMovies.downloadPage
  DownloadMovies.readMovies
module dependencies: MovieDataType ParseResponse
package dependencies: aeson-1.3.1.1 array-0.5.2.0
                      asn1-encoding-0.9.5 asn1-parse-0.9.4 asn1-types-0.3.2 async-2.2.1
                      attoparsec-0.13.2.2 base-4.11.1.0 base-compat-0.10.5 basement-0.0.8
                      binary-0.8.5.1 blaze-builder-0.4.1.0 bytestring-0.10.8.2
                      case-insensitive-1.2.0.11 cereal-0.5.7.0 conduit-1.3.1
                      connection-0.2.8 containers-0.5.11.0 cookie-0.4.4 cryptonite-0.25
                      data-default-class-0.1.2.0 deepseq-1.4.3.0 directory-1.3.1.5
                      dlist-0.8.0.5 exceptions-0.10.0 filepath-1.4.2 ghc-boot-th-8.4.4
                      ghc-prim-0.5.2.0 hashable-1.2.7.0 hourglass-0.2.12
                      http-client-0.5.13.1 http-client-tls-0.3.5.3 http-conduit-2.3.2
                      http-types-0.12.2 integer-gmp-1.0.2.0 integer-logarithms-1.0.2.2
                      memory-0.14.18 mtl-2.2.2 network-2.6.3.6 network-uri-2.6.1.0
                      parsec-3.1.13.0 pem-0.2.4 primitive-0.6.3.0 random-1.1
                      resourcet-1.2.2 scientific-0.3.6.2 socks-0.5.6 stm-2.4.5.1
                      streaming-commons-0.2.1.0 tagged-0.8.5 template-haskell-2.13.0.0
                      text-1.2.3.1 time-1.8.0.2 time-locale-compat-0.1.1.5 tls-1.4.1
                      transformers-0.5.5.0 unix-2.7.2.2 unliftio-core-0.1.2.0
                      unordered-containers-0.2.9.0 uuid-types-1.0.3 vector-0.12.0.1
                      x509-1.7.5 x509-store-1.6.7 x509-system-1.6.6
                      x509-validation-1.6.11 zlib-0.6.2
orphans: attoparsec-0.13.2.2:Data.Attoparsec.Text.Internal
         attoparsec-0.13.2.2:Data.Attoparsec.ByteString.Char8
         vector-0.12.0.1:Data.Vector.Unboxed
         vector-0.12.0.1:Data.Vector.Fusion.Bundle
         http-client-0.5.13.1:Network.HTTP.Client.Request
         basement-0.0.8:Basement.UArray.Base basement-0.0.8:Basement.Block
         transformers-0.5.5.0:Control.Monad.Trans.Error
         network-2.6.3.6:Network.Socket
         hashable-1.2.7.0:Data.Hashable.Generic text-1.2.3.1:Data.Text.Lazy
         text-1.2.3.1:Data.Text binary-0.8.5.1:Data.Binary.Generic
         bytestring-0.10.8.2:Data.ByteString.Builder
         text-1.2.3.1:Data.Text.Show stm-2.4.5.1:Control.Monad.STM
         time-1.8.0.2:Data.Time.Format.Parse
         time-1.8.0.2:Data.Time.LocalTime.Internal.ZonedTime
         time-1.8.0.2:Data.Time.LocalTime.Internal.LocalTime
         time-1.8.0.2:Data.Time.Calendar.Gregorian base-4.11.1.0:GHC.Float
         base-4.11.1.0:GHC.Base
family instance modules: aeson-1.3.1.1:Data.Aeson.Types.Internal
                         attoparsec-0.13.2.2:Data.Attoparsec.Internal.Types
                         base-4.11.1.0:Control.Applicative base-4.11.1.0:Data.Complex
                         base-4.11.1.0:Data.Functor.Compose base-4.11.1.0:Data.Functor.Const
                         base-4.11.1.0:Data.Functor.Identity
                         base-4.11.1.0:Data.Functor.Product base-4.11.1.0:Data.Functor.Sum
                         base-4.11.1.0:Data.Monoid base-4.11.1.0:Data.Semigroup
                         base-4.11.1.0:Data.Semigroup.Internal base-4.11.1.0:Data.Version
                         base-4.11.1.0:Data.Void base-4.11.1.0:GHC.Exts
                         base-4.11.1.0:GHC.Generics base-4.11.1.0:GHC.IO.Exception
                         basement-0.0.8:Basement.Block.Base basement-0.0.8:Basement.Monad
                         basement-0.0.8:Basement.MutableBuilder basement-0.0.8:Basement.Nat
                         basement-0.0.8:Basement.NonEmpty
                         basement-0.0.8:Basement.Numerical.Subtractive
                         basement-0.0.8:Basement.PrimType basement-0.0.8:Basement.String
                         basement-0.0.8:Basement.String.Encoding.ASCII7
                         basement-0.0.8:Basement.String.Encoding.ISO_8859_1
                         basement-0.0.8:Basement.String.Encoding.UTF16
                         basement-0.0.8:Basement.String.Encoding.UTF32
                         basement-0.0.8:Basement.Types.OffsetSize
                         basement-0.0.8:Basement.UArray.Base
                         basement-0.0.8:Basement.UTF8.Base
                         conduit-1.3.1:Data.Conduit.Internal.Conduit
                         conduit-1.3.1:Data.Conduit.Internal.Pipe
                         containers-0.5.11.0:Data.IntMap.Internal
                         containers-0.5.11.0:Data.IntSet.Internal
                         containers-0.5.11.0:Data.Map.Internal
                         containers-0.5.11.0:Data.Sequence.Internal
                         containers-0.5.11.0:Data.Set.Internal containers-0.5.11.0:Data.Tree
                         cryptonite-0.25:Crypto.ECC cryptonite-0.25:Crypto.Error.Types
                         cryptonite-0.25:Crypto.Hash.Blake2
                         cryptonite-0.25:Crypto.Hash.Blake2b
                         cryptonite-0.25:Crypto.Hash.Blake2bp
                         cryptonite-0.25:Crypto.Hash.Blake2s
                         cryptonite-0.25:Crypto.Hash.Blake2sp
                         cryptonite-0.25:Crypto.Hash.Keccak cryptonite-0.25:Crypto.Hash.MD2
                         cryptonite-0.25:Crypto.Hash.MD4 cryptonite-0.25:Crypto.Hash.MD5
                         cryptonite-0.25:Crypto.Hash.RIPEMD160
                         cryptonite-0.25:Crypto.Hash.SHA1 cryptonite-0.25:Crypto.Hash.SHA224
                         cryptonite-0.25:Crypto.Hash.SHA256 cryptonite-0.25:Crypto.Hash.SHA3
                         cryptonite-0.25:Crypto.Hash.SHA384
                         cryptonite-0.25:Crypto.Hash.SHA512
                         cryptonite-0.25:Crypto.Hash.SHA512t
                         cryptonite-0.25:Crypto.Hash.SHAKE
                         cryptonite-0.25:Crypto.Hash.Skein256
                         cryptonite-0.25:Crypto.Hash.Skein512
                         cryptonite-0.25:Crypto.Hash.Tiger
                         cryptonite-0.25:Crypto.Hash.Whirlpool dlist-0.8.0.5:Data.DList
                         ghc-boot-th-8.4.4:GHC.ForeignSrcLang.Type
                         ghc-boot-th-8.4.4:GHC.LanguageExtensions.Type
                         http-client-0.5.13.1:Network.HTTP.Client
                         network-uri-2.6.1.0:Network.URI
                         primitive-0.6.3.0:Control.Monad.Primitive
                         primitive-0.6.3.0:Data.Primitive.Array
                         primitive-0.6.3.0:Data.Primitive.ByteArray
                         resourcet-1.2.2:Control.Monad.Trans.Resource.Internal
                         tagged-0.8.5:Data.Tagged
                         template-haskell-2.13.0.0:Language.Haskell.TH.Syntax
                         text-1.2.3.1:Data.Text text-1.2.3.1:Data.Text.Lazy
                         topmovies-0.1.0.0-HqDPykmlaSdETrGbngTKrW:MovieDataType
                         unordered-containers-0.2.9.0:Data.HashMap.Base
                         unordered-containers-0.2.9.0:Data.HashSet
                         uuid-types-1.0.3:Data.UUID.Types.Internal
                         uuid-types-1.0.3:Data.UUID.Types.Internal.Builder
                         vector-0.12.0.1:Data.Vector vector-0.12.0.1:Data.Vector.Primitive
                         vector-0.12.0.1:Data.Vector.Storable
                         vector-0.12.0.1:Data.Vector.Unboxed
                         vector-0.12.0.1:Data.Vector.Unboxed.Base
                         zlib-0.6.2:Codec.Compression.Zlib.Stream
import  -/  base-4.11.1.0:Control.Exception 3d8e6cda20877f889f07bc7c0f5cac36
import  -/  base-4.11.1.0:Data.Either 39d922b371c4c52d426e9ee66de8371a
import  -/  base-4.11.1.0:Data.Maybe 409c3da2b142470b68be39ce1d97a9f7
import  -/  base-4.11.1.0:GHC.Base 604111500e81281298777e721c75643b
import  -/  base-4.11.1.0:GHC.IO 1d5542cc02075c5e948018bfacea89c1
import  -/  base-4.11.1.0:Prelude 0750c25585e2b797cd78291d423d39dd
import  -/  base-4.11.1.0:System.IO 40b9aff18a55c99eb253f9a43ff9b627
import  -/  bytestring-0.10.8.2:Data.ByteString 2b4288f7e6f19304c6573c69b0ec9578
import  -/  bytestring-0.10.8.2:Data.ByteString.Lazy f3d314dcb675ca8be2e537813d8eebbf
import  -/  ghc-prim-0.5.2.0:GHC.Types d9b3023de7feae4a5308d643da5543f7
import  -/  http-client-0.5.13.1:Network.HTTP.Client.Types ee95b1fab93847d0c7aa3bd15266c8b4
import  -/  http-conduit-2.3.2:Network.HTTP.Conduit d67b05d2fc8c0f013cbfcfbdfc25ac43
import  -/  network-uri-2.6.1.0:Network.URI 7fed68f204677dbbbb7c43405323d053
import  -/  MovieDataType 1220c84b655e5e6a9388c6c23260ae6c
  exports: 9a516822eea0563d11606a40129e72d9
  Movie e81709cca3321590f92169a4a102a621
import  -/  ParseResponse aaf71d872dcc26cb4aeeb01eec298519
  exports: b3e35cafd03918a66042cf18fae1ee89
  parseMovies 25c4d98e02643763495173342238e7bc
dbb18270e585a5ef6def0ac2966b1da9
  $trModule :: GHC.Types.Module
  {- HasNoCafRefs, Strictness: m,
     Unfolding: (GHC.Types.Module
                   DownloadMovies.$trModule3
                   DownloadMovies.$trModule1) -}
b85278ce2033778c423daada942de682
  $trModule1 :: GHC.Types.TrName
  {- HasNoCafRefs, Strictness: m1,
     Unfolding: (GHC.Types.TrNameS DownloadMovies.$trModule2) -}
577d94a7463356b2e436d2f528152bee
  $trModule2 :: GHC.Prim.Addr#
  {- HasNoCafRefs, Unfolding: ("DownloadMovies"#) -}
131dcd2eca79aded530c6262e68c16d3
  $trModule3 :: GHC.Types.TrName
  {- HasNoCafRefs, Strictness: m1,
     Unfolding: (GHC.Types.TrNameS DownloadMovies.$trModule4) -}
2c0f4a8c690c210793ef582bacb32d5d
  $trModule4 :: GHC.Prim.Addr#
  {- HasNoCafRefs,
     Unfolding: ("topmovies-0.1.0.0-HqDPykmlaSdETrGbngTKrW"#) -}
dd4b8c3c3523a77a4cdeb06375a841b0
  downloadMovies ::
    GHC.Base.String -> GHC.Base.String -> GHC.Types.IO ()
  {- Arity: 3, Strictness: <L,U><L,U><S,U>,
     Unfolding: InlineRule (0, True, True)
                DownloadMovies.downloadMovies1
                  `cast`
                (<GHC.Base.String>_R
                 ->_R <GHC.Base.String>_R
                 ->_R Sym (GHC.Types.N:IO[0] <()>_R)) -}
fc628f8888053c537a818d105e6a0d5d
  downloadMovies1 ::
    GHC.Base.String
    -> GHC.Base.String
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 3, Strictness: <L,U><L,U><S,U>,
     Unfolding: (\ (name :: GHC.Base.String)
                   (url :: GHC.Base.String)
                   (eta :: GHC.Prim.State# GHC.Prim.RealWorld) ->
                 GHC.Prim.catch#
                   @ ()
                   @ GHC.Exception.SomeException
                   (\ (s :: GHC.Prim.State# GHC.Prim.RealWorld)[OneShot] ->
                    case (Network.HTTP.Conduit.simpleHttp
                            @ GHC.Types.IO
                            Control.Monad.IO.Class.$fMonadIOIO
                            url)
                           `cast`
                         (GHC.Types.N:IO[0] <Data.ByteString.Lazy.Internal.ByteString>_R)
                           s of ds1 { (#,#) ipv ipv1 ->
                    case GHC.IO.Handle.Text.hPutStr2
                           GHC.IO.Handle.FD.stdout
                           (GHC.CString.unpackAppendCString#
                              DownloadMovies.downloadMovies7
                              url)
                           GHC.Types.True
                           ipv of ds2 { (#,#) ipv2 ipv3 ->
                    Data.ByteString.Lazy.writeFile1 name ipv1 ipv2 } })
                   DownloadMovies.downloadMovies2
                   eta) -}
1ae55e1e83da57b44b635a0ab4b0f4ac
  downloadMovies2 ::
    GHC.Exception.SomeException
    -> GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 2, Strictness: <S,1*U><S,U>,
     Unfolding: (\ (e1 :: GHC.Exception.SomeException)[OneShot]
                   (eta :: GHC.Prim.State# GHC.Prim.RealWorld) ->
                 case e1 of wild { GHC.Exception.SomeException e2 $dException1 e3 ->
                 case Data.Typeable.Internal.typeRepFingerprint
                        @ *
                        @ e2
                        (GHC.Exception.$p1Exception @ e2 $dException1)
                          `cast`
                        (Data.Typeable.Internal.N:Typeable[0] <*>_N <e2>_N) of wild1 { GHC.Fingerprint.Type.Fingerprint dt dt1 ->
                 case Network.HTTP.Client.Types.$fExceptionHttpException5 of wild2 { GHC.Fingerprint.Type.Fingerprint dt2 dt3 ->
                 case GHC.Prim.eqWord# dt dt2 of lwild {
                   DEFAULT
                   -> GHC.Prim.raiseIO# @ GHC.Exception.SomeException @ () wild eta
                   1#
                   -> case GHC.Prim.eqWord# dt1 dt3 of lwild1 {
                        DEFAULT
                        -> GHC.Prim.raiseIO# @ GHC.Exception.SomeException @ () wild eta
                        1#
                        -> case e3
                                  `cast`
                                (UnsafeCo representational e2 Network.HTTP.Client.Types.HttpException) of wild4 {
                             Network.HTTP.Client.Types.HttpExceptionRequest ds ds1
                             -> GHC.IO.Handle.Text.hPutStr2
                                  GHC.IO.Handle.FD.stdout
                                  DownloadMovies.downloadMovies5
                                  GHC.Types.True
                                  eta
                             Network.HTTP.Client.Types.InvalidUrlException ds ds1
                             -> GHC.IO.Handle.Text.hPutStr2
                                  GHC.IO.Handle.FD.stdout
                                  DownloadMovies.downloadMovies3
                                  GHC.Types.True
                                  eta } } } } } }) -}
b96a3dce03e8279bb19c3902f6c2386a
  downloadMovies3 :: [GHC.Types.Char]
  {- Unfolding: (GHC.CString.unpackCString#
                   DownloadMovies.downloadMovies4) -}
e5fb1e990505462f6c035431fd827913
  downloadMovies4 :: GHC.Prim.Addr#
  {- HasNoCafRefs, Unfolding: ("Bad URL"#) -}
bbe20ab3487c76aa6dada4d0e9b5eb31
  downloadMovies5 :: [GHC.Types.Char]
  {- Unfolding: (GHC.CString.unpackCString#
                   DownloadMovies.downloadMovies6) -}
438f997a341448f05e050213c0556991
  downloadMovies6 :: GHC.Prim.Addr#
  {- HasNoCafRefs, Unfolding: ("Http request failed"#) -}
8736f976876b9b1ddf5d5cefdc9f59e4
  downloadMovies7 :: GHC.Prim.Addr#
  {- HasNoCafRefs, Unfolding: ("Downloading file: "#) -}
f583632e4b22d189d0bd31782d67dfb4
  downloadPage :: GHC.Types.IO ()
  {- Arity: 1,
     Unfolding: InlineRule (0, True, True)
                DownloadMovies.downloadPage1
                  `cast`
                (Sym (GHC.Types.N:IO[0] <()>_R)) -}
da3695ca8570cba53487d864910aa552
  downloadPage1 ::
    GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, () #)
  {- Arity: 1,
     Unfolding: (DownloadMovies.downloadMovies1
                   DownloadMovies.downloadPage4
                   DownloadMovies.downloadPage2) -}
c2a166416d8b20fce8e485c578af6621
  downloadPage2 :: [GHC.Types.Char]
  {- Unfolding: (GHC.CString.unpackCString#
                   DownloadMovies.downloadPage3) -}
bb8400cafdd82b2a5c9f30f04f851097
  downloadPage3 :: GHC.Prim.Addr#
  {- HasNoCafRefs,
     Unfolding: ("https://editorial.rottentomatoes.com/guide/best-movies-of-2018"#) -}
e0f35ad9194187c4a660c8460ef140d4
  downloadPage4 :: [GHC.Types.Char]
  {- Unfolding: (GHC.CString.unpackCString#
                   DownloadMovies.downloadPage5) -}
0acf4dd04192d6a5bf035b0806b9551f
  downloadPage5 :: GHC.Prim.Addr#
  {- HasNoCafRefs, Unfolding: ("rottentomatoes.html"#) -}
3e3cdf80771084c197fd7a7a46ccf9f8
  readMovies :: GHC.Types.IO [MovieDataType.Movie]
  {- Arity: 1, Strictness: <S,U>,
     Unfolding: InlineRule (0, True, True)
                DownloadMovies.readMovies1
                  `cast`
                (Sym (GHC.Types.N:IO[0] <[MovieDataType.Movie]>_R)) -}
56b35bb7f95102256d2c7b3230a38738
  readMovies1 ::
    GHC.Prim.State# GHC.Prim.RealWorld
    -> (# GHC.Prim.State# GHC.Prim.RealWorld, [MovieDataType.Movie] #)
  {- Arity: 1, Strictness: <S,U>,
     Unfolding: (\ (s :: GHC.Prim.State# GHC.Prim.RealWorld) ->
                 case System.IO.withBinaryFile1
                        @ Data.ByteString.Internal.ByteString
                        DownloadMovies.downloadPage4
                        GHC.IO.IOMode.ReadMode
                        Data.ByteString.readFile2
                          `cast`
                        (<GHC.IO.Handle.Types.Handle>_R
                         ->_R Sym (GHC.Types.N:IO[0]
                                       <Data.ByteString.Internal.ByteString>_R))
                        s of ds1 { (#,#) ipv ipv1 ->
                 (# ipv, ParseResponse.parseMovies ipv1 #) }) -}
vectorised variables:
vectorised tycons:
vectorised reused tycons:
parallel variables:
parallel tycons:
trusted: none
require own pkg trusted: False

