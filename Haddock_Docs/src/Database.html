<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><a href="DownloadMovies.html"><span class="hs-identifier">DownloadMovies</span></a><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span> </span><a href="MovieDataType.html"><span class="hs-identifier">MovieDataType</span></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><a href="ParseResponse.html"><span class="hs-identifier">ParseResponse</span></a><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Database.HDBC</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Database.HDBC.Sqlite3</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Exception</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-comment">-- | The below functions are used for establishing a connection to the database</span><span>
</span><a name="line-12"></a><span class="hs-identifier">dbConnect</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Connection</span><span>
</span><a name="line-13"></a><a name="dbConnect"><a href="Database.html#dbConnect"><span class="hs-identifier">dbConnect</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">connectSqlite3</span><span> </span><span class="hs-string">&quot;DB.db&quot;</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Connection</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679092840"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679092840"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-16"></a><a name="r"><a href="Database.html#r"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bracket</span><span> </span><a href="Database.html#dbConnect"><span class="hs-identifier hs-var">dbConnect</span></a><span> </span><span class="hs-identifier hs-var">disconnect</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- | drops all tables in the database</span><span>
</span><a name="line-18"></a><span class="hs-identifier">dropDatabase</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Connection</span><span>
</span><a name="line-19"></a><a name="dropDatabase"><a href="Database.html#dropDatabase"><span class="hs-identifier">dropDatabase</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-20"></a><span>   </span><a name="local-6989586621679093296"><a href="#local-6989586621679093296"><span class="hs-identifier">conn</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.html#dbConnect"><span class="hs-identifier hs-var">dbConnect</span></a><span>
</span><a name="line-21"></a><span>   </span><span class="hs-identifier hs-var">run</span><span> </span><a href="#local-6989586621679093296"><span class="hs-identifier hs-var">conn</span></a><span> </span><span class="hs-string">&quot;DROP TABLE IF EXISTS movieTable&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-22"></a><span>   </span><span class="hs-identifier hs-var">run</span><span> </span><a href="#local-6989586621679093296"><span class="hs-identifier hs-var">conn</span></a><span> </span><span class="hs-string">&quot;DROP TABLE IF EXISTS starringTable&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-23"></a><span>   </span><span class="hs-identifier hs-var">run</span><span> </span><a href="#local-6989586621679093296"><span class="hs-identifier hs-var">conn</span></a><span> </span><span class="hs-string">&quot;DROP TABLE IF EXISTS movTable_starTable&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-24"></a><span>   </span><span class="hs-identifier hs-var">commit</span><span> </span><a href="#local-6989586621679093296"><span class="hs-identifier hs-var">conn</span></a><span>
</span><a name="line-25"></a><span>   </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679093296"><span class="hs-identifier hs-var">conn</span></a><span>
</span><a name="line-26"></a><span class="hs-comment">-- | Functions to specify the SQL tables</span><span>
</span><a name="line-27"></a><span class="hs-identifier">movieTable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-28"></a><a name="movieTable"><a href="Database.html#movieTable"><span class="hs-identifier">movieTable</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-29"></a><span>        </span><span class="hs-string">&quot;CREATE TABLE IF NOT EXISTS movieTable (\
	\id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\
	\rank INTEGER NOT NULL UNIQUE ,\
	\name VARCHAR(80) NOT NULL ,\
	\year INTEGER NOT NULL ,\
	\rating INTEGER NOT NULL,\
	\dirFName VARCHAR(40) NOT NULL,\
	\dirLName VARCHAR(40) NOT NULL);&quot;</span><span>
</span><a name="line-37"></a><span class="hs-identifier">starringTable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-38"></a><a name="starringTable"><a href="Database.html#starringTable"><span class="hs-identifier">starringTable</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-39"></a><span>        </span><span class="hs-string">&quot;CREATE TABLE IF NOT EXISTS starringTable (\
        \id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, \
        \starFName VARCHAR(40) NOT NULL, \
        \starLName VARCHAR(40) NOT NULL)&quot;</span><span>
</span><a name="line-43"></a><span class="hs-identifier">movTable_starTable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-44"></a><a name="movTable_starTable"><a href="Database.html#movTable_starTable"><span class="hs-identifier">movTable_starTable</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-45"></a><span>        </span><span class="hs-string">&quot;CREATE TABLE IF NOT EXISTS movTable_starTable (\
        \movieID INTEGER, \
        \starringID INTEGER, \
        \FOREIGN KEY(movieID) REFERENCES movieTable(id), \
        \FOREIGN KEY(starringID) REFERENCES starringTable(id) )&quot;</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-comment">-- | setupDatabase initialises the database creating tables</span><span>
</span><a name="line-52"></a><span class="hs-identifier">setupDatabase</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Connection</span><span>
</span><a name="line-53"></a><a name="setupDatabase"><a href="Database.html#setupDatabase"><span class="hs-identifier">setupDatabase</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-54"></a><span>    </span><a name="local-6989586621679093297"><a href="#local-6989586621679093297"><span class="hs-identifier">conn</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.html#dbConnect"><span class="hs-identifier hs-var">dbConnect</span></a><span>
</span><a name="line-55"></a><span>    </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-string">&quot;Connection Successful&quot;</span><span>
</span><a name="line-56"></a><span>    </span><span class="hs-identifier hs-var">run</span><span> </span><a href="#local-6989586621679093297"><span class="hs-identifier hs-var">conn</span></a><span> </span><a href="Database.html#movieTable"><span class="hs-identifier hs-var">movieTable</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-57"></a><span>    </span><span class="hs-identifier hs-var">run</span><span> </span><a href="#local-6989586621679093297"><span class="hs-identifier hs-var">conn</span></a><span> </span><a href="Database.html#starringTable"><span class="hs-identifier hs-var">starringTable</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-58"></a><span>    </span><span class="hs-identifier hs-var">run</span><span> </span><a href="#local-6989586621679093297"><span class="hs-identifier hs-var">conn</span></a><span> </span><a href="Database.html#movTable_starTable"><span class="hs-identifier hs-var">movTable_starTable</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-identifier hs-var">commit</span><span> </span><a href="#local-6989586621679093297"><span class="hs-identifier hs-var">conn</span></a><span>
</span><a name="line-61"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679093297"><span class="hs-identifier hs-var">conn</span></a><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-identifier">insertOne</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-65"></a><a name="insertOne"><a href="Database.html#insertOne"><span class="hs-identifier">insertOne</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-66"></a><span>        </span><span class="hs-string">&quot;INSERT OR REPLACE INTO movieTable(\
	\rank,\
	\name,\
	\year,\
	\rating,\
	\dirFName,\
	\dirLName)\
	\VALUES (?,?,?,?,?,?)&quot;</span><span>
</span><a name="line-74"></a><span class="hs-identifier">insertTwo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-75"></a><a name="insertTwo"><a href="Database.html#insertTwo"><span class="hs-identifier">insertTwo</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-76"></a><span>        </span><span class="hs-string">&quot;INSERT OR REPLACE INTO starringTable (\
	\starFName, \
	\starLName) \
        \VALUES (?,?)&quot;</span><span>
</span><a name="line-80"></a><span class="hs-identifier">insertThree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-81"></a><a name="insertThree"><a href="Database.html#insertThree"><span class="hs-identifier">insertThree</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-82"></a><span>        </span><span class="hs-string">&quot;INSERT OR REPLACE INTO movTable_starTable (\
	\movieID, \
	\starringID) \
	\VALUES (?,?)&quot;</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-comment">-- | populateMovies populates movie data into a table of its own.</span><span>
</span><a name="line-88"></a><span class="hs-comment">-- | Begins by preparing Connections</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- | Then inserts and Commit</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-identifier">populateMovies</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><a name="populateMovies"><a href="Database.html#populateMovies"><span class="hs-identifier">populateMovies</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-93"></a><span>     </span><a name="local-6989586621679093298"><a href="#local-6989586621679093298"><span class="hs-identifier">movieDataset</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DownloadMovies.html#readMovies"><span class="hs-identifier hs-var">readMovies</span></a><span>
</span><a name="line-94"></a><span>     </span><a name="local-6989586621679093299"><a href="#local-6989586621679093299"><span class="hs-identifier">conn</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.html#dbConnect"><span class="hs-identifier hs-var">dbConnect</span></a><span>
</span><a name="line-95"></a><span>     </span><a name="local-6989586621679093300"><a href="#local-6989586621679093300"><span class="hs-identifier">stmt</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">prepare</span><span> </span><a href="#local-6989586621679093299"><span class="hs-identifier hs-var">conn</span></a><span> </span><a href="Database.html#insertOne"><span class="hs-identifier hs-var">insertOne</span></a><span>
</span><a name="line-96"></a><span>     </span><a name="local-6989586621679093301"><a href="#local-6989586621679093301"><span class="hs-identifier">stmt2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">prepare</span><span> </span><a href="#local-6989586621679093299"><span class="hs-identifier hs-var">conn</span></a><span> </span><a href="Database.html#insertTwo"><span class="hs-identifier hs-var">insertTwo</span></a><span>
</span><a name="line-97"></a><span>     </span><a name="local-6989586621679093302"><a href="#local-6989586621679093302"><span class="hs-identifier">stmt3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">prepare</span><span> </span><a href="#local-6989586621679093299"><span class="hs-identifier hs-var">conn</span></a><span> </span><a href="Database.html#insertThree"><span class="hs-identifier hs-var">insertThree</span></a><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span>     </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679093303"><a href="#local-6989586621679093303"><span class="hs-identifier">insertMovies</span></a></a><span> </span><a name="local-6989586621679093304"><a href="#local-6989586621679093304"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">toSql</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rank</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679093298"><span class="hs-identifier hs-var">movieDataset</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679093304"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-100"></a><span>                           </span><span class="hs-identifier hs-var">toSql</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679093298"><span class="hs-identifier hs-var">movieDataset</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679093304"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-101"></a><span>                           </span><span class="hs-identifier hs-var">toSql</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">year</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679093298"><span class="hs-identifier hs-var">movieDataset</span></a><span> </span><span class="hs-operator hs-var">!!</span><span class="hs-special">(</span><a href="#local-6989586621679093304"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-102"></a><span>                           </span><span class="hs-identifier hs-var">toSql</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rating</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679093298"><span class="hs-identifier hs-var">movieDataset</span></a><span> </span><span class="hs-operator hs-var">!!</span><span class="hs-special">(</span><a href="#local-6989586621679093304"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-103"></a><span>                           </span><span class="hs-identifier hs-var">toSql</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">takeWhile</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-char">' '</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">director</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679093298"><span class="hs-identifier hs-var">movieDataset</span></a><span> </span><span class="hs-operator hs-var">!!</span><span class="hs-special">(</span><a href="#local-6989586621679093304"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-104"></a><span>                           </span><span class="hs-identifier hs-var">toSql</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">takeWhile</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-char">' '</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">director</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679093298"><span class="hs-identifier hs-var">movieDataset</span></a><span> </span><span class="hs-operator hs-var">!!</span><span class="hs-special">(</span><a href="#local-6989586621679093304"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span>     </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679093959"><a href="#local-6989586621679093959"><span class="hs-identifier">insertActors</span></a></a><span> </span><a name="local-6989586621679093960"><a href="#local-6989586621679093960"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">toSql</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">takeWhile</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-char">' '</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">starring</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679093298"><span class="hs-identifier hs-var">movieDataset</span></a><span class="hs-operator hs-var">!!</span><span class="hs-special">(</span><a href="#local-6989586621679093960"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-107"></a><span>                            </span><span class="hs-identifier hs-var">toSql</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">.</span><span>  </span><span class="hs-identifier hs-var">takeWhile</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-char">' '</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">starring</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679093298"><span class="hs-identifier hs-var">movieDataset</span></a><span class="hs-operator hs-var">!!</span><span class="hs-special">(</span><a href="#local-6989586621679093960"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span>     </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679093961"><a href="#local-6989586621679093961"><span class="hs-identifier">insertActorsMovies</span></a></a><span> </span><a name="local-6989586621679093962"><a href="#local-6989586621679093962"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">toSql</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679093962"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toSql</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679093962"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-110"></a><span>     </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679093963"><a href="#local-6989586621679093963"><span class="hs-identifier">populateMovieTable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679093303"><span class="hs-identifier hs-var">insertMovies</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-number">152</span><span class="hs-special">]</span><span>
</span><a name="line-111"></a><span>     </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679093964"><a href="#local-6989586621679093964"><span class="hs-identifier">populateActors</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679093959"><span class="hs-identifier hs-var">insertActors</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-number">152</span><span class="hs-special">]</span><span>
</span><a name="line-112"></a><span>     </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679093965"><a href="#local-6989586621679093965"><span class="hs-identifier">populateActorsMovies</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679093961"><span class="hs-identifier hs-var">insertActorsMovies</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-number">152</span><span class="hs-special">]</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span>     </span><span class="hs-identifier">executeMany</span><span> </span><a href="#local-6989586621679093300"><span class="hs-identifier hs-var">stmt</span></a><span> </span><a href="#local-6989586621679093963"><span class="hs-identifier hs-var">populateMovieTable</span></a><span>
</span><a name="line-115"></a><span>     </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-string">&quot;Movies inserted successfully&quot;</span><span>
</span><a name="line-116"></a><span>     </span><span class="hs-identifier hs-var">commit</span><span> </span><a href="#local-6989586621679093299"><span class="hs-identifier hs-var">conn</span></a><span>
</span><a name="line-117"></a><span>     </span><span class="hs-identifier">executeMany</span><span> </span><a href="#local-6989586621679093301"><span class="hs-identifier hs-var">stmt2</span></a><span> </span><a href="#local-6989586621679093964"><span class="hs-identifier hs-var">populateActors</span></a><span>
</span><a name="line-118"></a><span>     </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-string">&quot;Stars inserted successfully&quot;</span><span>
</span><a name="line-119"></a><span>     </span><span class="hs-identifier hs-var">commit</span><span> </span><a href="#local-6989586621679093299"><span class="hs-identifier hs-var">conn</span></a><span>
</span><a name="line-120"></a><span>     </span><span class="hs-identifier">executeMany</span><span> </span><a href="#local-6989586621679093302"><span class="hs-identifier hs-var">stmt3</span></a><span> </span><a href="#local-6989586621679093965"><span class="hs-identifier hs-var">populateActorsMovies</span></a><span>
</span><a name="line-121"></a><span>     </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-string">&quot;All Successful&quot;</span><span>
</span><a name="line-122"></a><span>     </span><span class="hs-identifier hs-var">commit</span><span> </span><a href="#local-6989586621679093299"><span class="hs-identifier hs-var">conn</span></a><span>
</span><a name="line-123"></a></pre></body></html>